FORMAT: 1A
HOST: https://api-sandbox.split.cash/

# Split API V1
![Split](https://raw.githubusercontent.com/krakendevelopments/public_assets/master/images/Split_Logo_rgb.png)

Welcome to the Split V1 API documentation. Use the Split API to help streamline your financial processes and supercharge your current system.

## Quick start

### 1. Create a Split account
If you haven't already, you'll want to create a sandbox Split account at https://go-sandbox.split.cash

### 2. Register your application with Split
Once you've got your account up and running, sign in and create an OAuth2 profile for your application: https://go-sandbox.split.cash/oauth/applications

| Parameter | Description |
|-----------|-------------|
| **Name**  | The name of your application. When using the the *Authorisation Grant Flow*, users will see this name as the application requesting access to their account. |
| **Redirect URI** | Set this to your application's endpoint charged with receiving the authorisation code. If you're using [Postman](https://www.getpostman.com/) to play with the API, use the Postman callback URL: `https://www.getpostman.com/oauth2/callback` |

### 2.a Quick fun
Perform this optional step if you just want to play with the API without writing any code, otherwise continue to [3. Obtain authorisation code](#introduction/quick-start/3.-obtain-authorisation-code).

The following uses the OAuth2 process built-in to [Postman](https://www.getpostman.com/) in order to obtain an authorisation code from a user and finally exchange it for an access code.

1. Add the Split API collection to Postman: [![Run in Postman](https://run.pstmn.io/button.png)](https://www.getpostman.com/run-collection/7e421b9ba68f3d37bd7c)
2. Within Postman, click on any of the Split endpoints.
3. Click on the **Authorization** sub-tab.
4. Select **OAuth 2.0** in the **Type** dropdown.
5. Click **Get New Access Token**.
6. Fill in the form, replacing `{{ application_id }}` & `{{ application_secret }}` with the ones you got when you registered your app in step 2.
![Postman OAuth2](https://raw.githubusercontent.com/krakendevelopments/public_assets/master/images/postman_oauth2_form.png)
7. Click **Request Token** and wait a few seconds.
8. Go through the authorisation process, once complete, Postman will store the `access_token` and `refresh_token` for you to use in subsequent requests.
9. Click on **Use Token** and Postman will automatically place the newly acquired **access_token** in the request header, ready for your first request to the SPlit API.
10. You no longer have to perform the following steps 3, 4 & 5.

### 3. Obtain authorisation code
Construct the initial URL the user will need to visit in order to grant your application permission to act on his/her behalf. The constructed URL describes the level of permission (`scope`),
the application requesting permission (`client_id`) and where the user gets redirected once they've grant permission (`redirect_uri`).

The URL should be formatted to look like this:
`https://go-sandbox.split.cash/oauth/authorize?response_type=code&client_id={client_id}&redirect_uri={redirect_uri}&scope={scope}`

| Parameter | Description |
|-----------|-------------|
| `response_code` | Always set to `code` |
| `client_id` | This is your `Application Id` as generated when you registered your application with Split |
| `redirect_uri` | URL where the user will get redirected along with the newly generated authorisation code |
| `scope` | The scope of permission you're requesting |

### 4. Exchange authorisation code for access token
When the user visits the above-mentioned URL, they will be presented with a Split login screen and then an authorisation screen:
![Split authorisation screen](https://raw.githubusercontent.com/krakendevelopments/public_assets/master/images/oauth_authorise.png)

After the user has visited the URL in step 3 and authorised your application, the will be returned to your application at the URL specified in `redirect_uri` along with the `code` query parameter as the authorisation code.

Finally, the authorisation code can than be exchanged for an access token and refresh token pair by POSTing to: `https://go-sandbox.split.cash/oauth/token`

| Parameter | Description |
|-----------|-------------|
| `grant_type` | Set to `authorization_code` |
| `client_id` | This is your `Application Id` as generated when you registered your application with Split |
| `client_secret` | This is your `Secret` as generated when you registered your application with Split |
| `code` | The authorisation code returned with the user |
| `redirect_uri` | Same URL used in step 3 |
| `scope` | The scope of permission you're requesting |

### 5. Wrap-up
You should now have an access token and refresh token which allows you to interact with the Split API as the user related to the access token.
To do so, you must simply append the access token to the header of any API request: `Authorization: Bearer {access_token}`

**Notes:**

* Often times you'll want to grant your own app access to itself. To do this, you must go through steps 1 to 4 and on step 3 authenticate using the same user that owns the application as registered with Split.
* As noted above, the access token expires every 2 hours. To get a new access token without going through steps 1 to 4 again, use the refresh grant strategy to swap a refresh token for a new access token.

## Schema

* All communication is via `https`
* The production API is accessed from `https://api.split.cash/`.
* The production UI is accessed from `https://go.split.cash/`.
* The sandbox API is accessed from `https://api-sandbox.split.cash/`
* The sandbox UI is accessed from `https://go-sandbox.split.cash/`
* Data is sent and received as JSON.
* Currencies are represented by 3 characters as defined in [ISO 4217](http://www.xe.com/iso4217.php).
* Dates & times are returned in UTC using [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601) format with millisecond accuracy.
* Amounts are always in cents with no decimals unless otherwise stated.
* This documentation and supporting tools uses the sandbox environment. When you're ready to go live simply remove the `-sandbox.` from the API URL.

## Playground
The best way to familiarise yourself with our API is by interacting with it. We suggest you use the free [Postman](https://www.getpostman.com/) app
where we've prepared all our API endpoints in a tidy collection ready for you to play with.

Click the button below to import our Split collection and get started:

[![Run in Postman](https://run.pstmn.io/button.png)](https://www.getpostman.com/run-collection/7e421b9ba68f3d37bd7c)

## Authentication and Authorisation
Split uses OAuth2 over https to manage authentication and authorisation.

We currently support the following types of OAuth2 grants:

### Authorisation Code Grant
This type of grant allows your application to act on behalf of a user. If you've ever used a website or application with your
Google, Twitter or Facebook account, this is the grant being used. See the [Getting Started section](#introduction/getting-started) more details.

#### Example POSTing an authorisation code with cURL to get an access & refresh token pair
**Request**

```
curl -F "grant_type=authorization_code" \
     -F "client_id={{ client_id }}" \
     -F "client_secret={{ client_secret }}" \
     -F "code={{ authorization_code }}" \
     -F "redirect_uri=https://www.getpostman.com/oauth2/callback" \
     -X POST "https://go-sandbox.split.cash/oauth/token"
```

**Response**

```
{
    "access_token":"dbaf9757982a9e738f05d249b7b5b4a266b3a139049317c4909f2f263572c781",
    "token_type":"bearer",
    "expires_in":7200,
    "refresh_token":"76ba4c5c75c96f6087f58a4de10be6c00b29ea1ddc3b2022ee2016d1363e3a7c",
    "scope":"public"
}
```

### Refresh Token Grant
When using the authorisation code grant above, Split will return a `refresh token` along with the access token. Access tokens are short lived and last 2 hours but refresh tokens do not expire.
When the access token expires, instead of sending the user back through the authorisation flow you can use the refresh token to retrieve a new access token with the same permissions as the old one.

> **Note:** The `refresh_token` gets regenerated and sent alongside the new `access_token`. In other words, `refresh_token`s are single use so you'll
want to store the newly generated `refresh_token` everytime you use it to get a new `acccess_token`

#### Example POSTing a refresh token with cURL to get a new access & refresh token pair
**Request**

```
curl -F "grant_type=refresh_token" \
     -F "client_id={{ client_id }}" \
     -F "client_secret={{ client_secret }}" \
     -F "refresh_token={{ refresh_token }}" \
     -X POST https://go-sandbox.split.cash/oauth/token
```

**Response**

```
{
    "access_token":"ad0b5847cb7d254f1e2ff1910275fe9dcb95345c9d54502d156fe35a37b93e80",
    "token_type":"bearer",
    "expires_in":7200,
    "refresh_token":"cc38f78a5b8abe8ee81cdf25b1ca74c3fa10c3da2309de5ac37fde00cbcf2815",
    "scope":"public"
}
```

<!---
### Client Credentials Grant
This is the grant you want to use when you want your application to act on an account which belongs to itself.                                             
--->

### Scopes
When requesting access you need to pass along with it the level of access you require. These are called scopes and Split supports the following:

| Scope | Description |
|--------|------------|
| `public` | View user's public information |
| `agreements` | Manage user's agreements **(Coming soon)** |
| `contacts` | Manage user's contacts |
| `payments` | Manage user's payments |
| `payment_requests` | Manage user's payment requests |
| `refund_requests` | Manage user's refund requests |
| `transactions` | Access user's transactions |

## Pagination
All collections are paginated to 100 items by default. You can request the following page by appending `?page=x` where `x` is the page you'd like to retrieve.

You can extract the pagination information from the response header:

```
Link: <https://api-sandbox.split.cash/payments?page=2>; rel="next",
  <https://api-sandbox.split.cash/payments?page=15>; rel="last"
```

## Response Codes
The common [HTTP Response Status Codes](https://github.com/for-GET/know-your-http-well/blob/master/status-codes.md) are used with all responses.

## Glossary

| Term          | Description |
|---------------|-------------|
| **Split account** | In Split, transactions are conducted between accounts. Split currently supports `business` accounts with planned support for `personal` accounts in the near future. |
| **Split user**    | An authorised representative of a Split account |
| **Maturation date** | Every payment has a maturation date. This date tells us when we can process your payment. E.g. by default, we will wait 3 days from the day you created the payment before we debit your account in order to give you time to settle the funds in your account. The maturation date can be controlled when you create a new payment. |


# Group Agreements

> **NOTE**: This is an experimental feature that has not yet been released. Please contact us at [info@splitpayments.com.au](mailto:info@splitpayments.com.au) to get early access.

Split Agreements are managed on a per contact basis and allow two Split accounts to agree on terms in order to automate the [Payment on Request (PoR)](#reference/payments-on-request) approval process.

**Example**

*AgileSupplier frequently sends PoRs to SuperSeller. AgileSupplier would like the PoRs to SuperSeller under $500 to be automatically approved.*

*AgileSupplier sends an agreement request to SuperSeller containing the terms. SuperSeller approves the agreement request and all future PoRs from AgileSupplier under
$500 are automatically approved.*

## Types
Each agreement is unidirectional. In other words, an agreement is required for each PoR direction.

In order to identify the agreements, there are two types:

1. **Incoming:** Agreement received from another Split account
2. **Outgoing:** Agreement sent to another Split account

**Example**

*Split Account A (SAA) would like all the PoRs they send to Split Account B (SAB) up to $500 to be automatically approved. SAA therefore sends SBB an agreement request.*

*SAB would also like all the PoRs they sends to SAA up to $500 to be automatically approved. SAB therefore sends SAA and agreement request.*

## List or request agreement [/agreements{?page}]
**Endpoint:** `/agreements`

### List all agreements | GET [GET]

+ Parameters
    + page: 1 (optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.spli.cash/agreements?page=2>; rel="next", <http:/api-sandbox.split.cash/agreements?page=8>; rel="last"

    + Body
    
            [
                {
                    "id": "b7cb7f5d-a699-49b0-b895-97fb6b8ce191",
                    "account_nickname": "oustanding_tours",
                    "contact_id": null
                    "type": "incoming",
                    "status": "pending_approval",
                    "terms": {
                        "per_payment": {
                            "min": 0,
                            "max": 50000
                        }
                    }
                },
                {
                    "id": "7af3973b-f958-4b35-b2a6-1e54d2e8492e",
                    "account_nickname": "big_trucks",
                    "contact_id": "81a80df3-10aa-416f-a10a-77f4cd4a6c4d"
                    "type": "outgoing",
                    "status": "approved",
                    "terms": {
                        "per_payment": {
                            "min": 0,
                            "max": 50000
                        }
                    }
                },
                {
                    "id": "7af3973b-f958-4b35-b2a6-1e54d2e8492e",
                    "account_nickname": "big_trucks",
                    "contact_id": "81a80df3-10aa-416f-a10a-77f4cd4a6c4d"
                    "type": "incoming",
                    "status": "approved",
                    "terms": {
                        "per_payment": {
                            "min": 0,
                            "max": 50000
                        }
                    },
                },
                {
                    "id": "631277f2-93f8-4ec3-b83e-66ef366f3d3f",
                    "account_nickname": "crystal_lampers",
                    "contact_id": "c25f8705-754b-4ac6-b3e6-d8647a4a340b"
                    "type": "outgoing",
                    "status": "declined",
                    "terms": {
                        "per_payment": {
                            "min": 0,
                            "max": 980000
                        }
                    }
                }
            ]

### Send an agreement request | POST [POST]
    
+ Attributes
    + contact_id: `48b89364-1577-4c81-ba02-96705895d457` (string, required) - The ID of the recipient payment
    + terms
        + per_payment
            + min: 0 (number, required) - Minimum amount in cents a PoR must be in order to be auto-approved
            + max: 50000 (number, required) - Maximum amount in cents a PoR must be in order to be auto-approved

+ Request (application/json)

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9

+ Response 201 (application/json)

        {
            "id": "b7cb7f5d-a699-49b0-b895-97fb6b8ce191",
            "account_nickname": "oustanding_tours",
            "contact_id": "48b89364-1577-4c81-ba02-96705895d457"
            "type": "outgoing",
            "status": "pending_approval",
            "terms": {
                "per_payment": {
                    "min": 0,
                    "max": 50000
                }
            }
        }


## Manage agreements [/agreements/{id}]
**Endpoint:** `/agreements/{id}`

> **Note:** Approving an agreement request will automatically add the Split account to your contact list should it not already be there.

### Approve or decline an agreement request | PATCH [PATCH]

+ Parameters
    + id: `7af3973b-f958-4b35-b2a6-1e54d2e8492e` (required) - agreement ID

+ Attributes
    + status: `approve` (string, required) - Possible values: `approve`, `decline`

+ Request (application/json)

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
            
+ Response 200 (application/json)

        {
            "id": "7af3973b-f958-4b35-b2a6-1e54d2e8492e",
            "account_nickname": "big_trucks",
            "contact_id": "81a80df3-10aa-416f-a10a-77f4cd4a6c4d"
            "type": "incoming",
            "status": "approved",
            "terms": {
                "per_payment": {
                    "min": 0,
                    "max": 50000
                }
            }
        }

### Retrieve an agreement | GET [GET]

+ Parameters
    + id: `7af3973b-f958-4b35-b2a6-1e54d2e8492e` (required) - agreement ID
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9

+ Response 200 (application/json)

        {
            "id": "7af3973b-f958-4b35-b2a6-1e54d2e8492e",
            "account_nickname": "big_trucks",
            "contact_id": "81a80df3-10aa-416f-a10a-77f4cd4a6c4d"
            "type": "incoming",
            "status": "approved",
            "terms": {
                "per_payment": {
                    "min": 0,
                    "max": 50000
                }
            }
        }
        

            
### Cancel an agreement | DELETE [DELETE]
Only outgoing agreements (agreements initated by the authenticated account) can be cancelled.

+ Parameters
    + id: `7af3973b-f958-4b35-b2a6-1e54d2e8492e` (required) - agreement ID

+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9

+ Response 204

# Group Contacts
Your contacts form an address book of Split accounts with whom you can interact. In order to create a [Payment](#reference/payments) or
a [Payment on Request](#reference/payments-on-request) you must first have the recipient Split account as part of your contacts.

## Add or list contacts [/contacts{?page}]
**Endpoint:** `/contacts{?page}`

### Add a contact | POST [POST]

+ Request (application/json)

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9

    + Body
    
            {
                "nickname": "outstanding_tours"
            }


+ Response 201 (application/json)

        {
          "data": {
            "id": "55afddde-4296-4daf-8e49-7ba481ef9608",
            "account_number": "947434694",
            "branch_code": "304304",
            "state": "active",
            "business": {
              "nickname": "outstanding_tours",
              "abn": "123456789",
              "name": "Outstanding Tours Pty Ltd"
            }
          }dickens-brothers-3
        }

+ Response 404

### List all contacts | GET [GET]

+ Parameters
    + page: 1 (optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.split.cash/contacts?page=2>; rel="next", <http:/api-sandbox.split.cash/contacts?page=8>; rel="last"
    
    + Body
            
            {
              "data": [
                {
                  "id": "095c5ab7-7fa8-40fd-b317-cddbbf4c8fbc",
                  "account_number": "494307",
                  "branch_code": "435434",
                  "state": "active",
                  "business": {
                    "nickname": "outstanding_tours",
                    "abn": "123456789",
                    "name": "Oustanding Tours Pty Ltd"
                  }
                },
                {   
                  "id": "861ff8e4-7acf-4897-9e53-e7c5ae5f7cc0",
                  "account_number": "4395959",
                  "branch_code": "068231",
                  "state": "active",
                  "business": {
                    "nickname": "adventure_dudes",
                    "abn": "126754389",
                    "name": "Adventure Dudes Pty Ltd"
                  }
                },
                {
                  "id": "3156e4e6-688e-4f95-a591-f1a4fb3b768a",
                  "account_number": "493584",
                  "branch_code": "022434",
                  "state": "suspended",
                  "business": {
                    "nickname": "surfing_world",
                    "abn": "295443789",
                    "name": "Surfing World Pty Ltd"
                  }
                }
              ]
            }
        
## Get or remove a contact [/contacts/{nickname}]
**Endpoint:** `/contacts/{nickname}`

### Get a contact | GET [GET]

+ Parameters
    + nickname: `outstanding_tours` - Contact's account nickname
    
+ Request
    
    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

        {
          "data": {
            "id": "55afddde-4296-4daf-8e49-7ba481ef9608",
            "account_number": "947434694",
            "branch_code": "304304",
            "state": "active",
            "business": {
              "nickname": "outstanding_tours",
              "abn": "123456789",
              "name": "Outstanding Tours Pty Ltd"
            }
          }
        }

+ Response 404 (application/json)

        {
            "errors": [
                "Cannot find requested Split account"
            ]
        }


### Remove a contact | DELETE [DELETE]

+ Parameters
    + nickname: `outstanding_tours` - Contact's account nickname
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 204

# Group Payments

**A payment is made up of two parts:**

1. General details about the payment.
2. One or many recipients with individual amounts and descriptions. These are referred to as Payouts.

   **Example**
   
   *SuperAgent sells a package that includes a skydive & a scuba for a total of $600.*
   
   *The general details of the payment would include a description of "Skydive & Scuba Package Special" and a maturation date of 3 days later*
   
   *SuperAgent would also add the 2 suppliers as recipients of the payment to each receive $300 with personalised descriptions.*
   
## Make or list payments [/payments{?page}]
**Endpoint:** `/payments{?page}`

### Make a payment | POST [POST]

+ Attributes
    + description: The SuperPackage (string, required) - User description. Only visible to the payer
    + matures_at: 2016-09-13T00:00:00Z (string, required) - Date & time in UTC ISO8601 the payment should be processed
    + payouts (array, required) - One or many contact to pay (2 recipients in this example)
        + (object)
            + amount: 30000 (number, required) - Amount in cents to pay the recipient
            + description: `A tandem skydive jump SB23094` (string, required) - Description that both the payer an recipient can see
            + recipient_id: `48b89364-1577-4c81-ba02-96705895d457` (string, required) - Contact to pay
        + (object)
            + amount: 30000 (number, required) - Amount in cents to pay the recipient
            + description: `A scuba dive SDS5464` (string, required) - Description that both the payer an recipient can see
            + recipient_id: `dc6f1e60-3803-43ca-a200-7d641816f57f` (string, required) - Contact to pay
            

+ Request (application/json)

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
        
+ Response 201 (application/json)

        {
          "data": {
            "ref": "PB.1",
            "payouts": [
              {
                "ref": "D.1",
                "batch_description": "The SuperPackage",
                "matures_on": "2016-09-13T23:50:44Z",
                "created_at": "2016-09-10T23:50:44Z",
                "amount": 30000,
                "description": "A tandem skydive jump SB23094",
                "from_id": "83623359-e86e-440c-9780-432a3bc3626f",
                "to_id": "48b89364-1577-4c81-ba02-96705895d457"
              },
              {
                "ref": "D.2",
                "batch_description": "The SuperPackage",
                "matures_on": "2016-09-13T23:50:44Z",
                "created_at": "2016-09-10T23:50:44Z",
                "amount": 30000,
                "description": "A scuba dive SDS5464",
                "from_id": "48b89364-1577-4c81-ba02-96705895d457",
                "to_id": "dc6f1e60-3803-43ca-a200-7d641816f57f"
              }
            ]
          }
        }

### List all payments | GET [GET]
+ Parameters
    + page: 1 (string, optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.split.cash/payments?page=2>; rel="next", <http:/api-sandbox.split.cash/payments?page=8>; rel="last"

    + Body
    
            {
              "data": [
                {
                  "ref": "PB.1",
                  "payouts": [
                    {
                      "ref": "D.1",
                      "batch_description": "This description is only available to the payer",
                      "matures_on": "2016-09-13T23:50:44Z",
                      "created_at": "2016-09-10T23:50:44Z",
                      "amount": 30000,
                      "description": "The recipient will see this description",
                      "from_id": "83623359-e86e-440c-9780-432a3bc3626f",
                      "to_id": "48b89364-1577-4c81-ba02-96705895d457"
                    },
                    {
                      "ref": "P.2",
                      "batch_description": "This description is only available to the payer",
                      "matures_on": "2016-09-13T23:50:44Z",
                      "created_at": "2016-09-10T23:50:44Z",
                      "amount": 30000,
                      "description": "The recipient will see this description",
                      "from_id": "48b89364-1577-4c81-ba02-96705895d457",
                      "to_id": "dc6f1e60-3803-43ca-a200-7d641816f57f"
                    }
                  ]
                }
              ]
            }

## Get or void a payment [/payments/{ref}]
**Endpoint:** `/payments/{ref}`

### Get a payment | GET [GET]

+ Parameters
    + ref: `PB.1` (string, required) - Payment reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)
    
        {
          "data": {
            "ref": "PB.1",
            "payouts": [
              {
                "ref": "D.1",
                "batch_description": "The SuperPackage",
                "matures_on": "2016-09-13T23:50:44Z",
                "created_at": "2016-09-10T23:50:44",
                "amount": 30000,
                "description": "A tandem skydive jump SB23094",
                "from_id": "83623359-e86e-440c-9780-432a3bc3626f",
                "to_id": "48b89364-1577-4c81-ba02-96705895d457"
              },
              {
                "ref": "D.2",
                "batch_description": "The SuperPackage",
                "matures_on": "2016-09-13T23:50:44Z",
                "created_at": "2016-09-10T23:50:44Z",
                "amount": 30000,
                "description": "A scuba dive SDS5464",
                "from_id": "48b89364-1577-4c81-ba02-96705895d457",
                "to_id": "dc6f1e60-3803-43ca-a200-7d641816f57f"
              }
            ]
          }
        }

### Void a payment | DELETE [DELETE]

+ Parameters
    + ref: `PB.1` - Payment reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 204 (application/json)


# Group Payment Requests

A Payment Request (PR) is used in order to get paid by another Split account.
A PR is very similar to a [Payment](#reference/payments), the main differences are:

* A PR is initiated by the recipient of the payment
* A PR has only one recipient which is the initiator of the PR. This happens automatically.
* A PR needs to be approved (manually or automatically) by the PR payer.

**Example scenario**

*Rafting Co. requires SmallAgent to pay them $500 for a rafting tour that was previously sold by SmallAgent.
Rafting Co. sends a PR for $500 with to SmallAgent.*

*SmallAgent will receive a notification that a PR from Rafting Co. for $500 requires approval. Once SmallAgent approves, the payment will
be processed according to the maturation date.*

## Types
Since PRs are visible by both the payer and payee, we identify who created the PR by using types:

1. **Incoming:** An incoming Payment Request (you are the authoriser/payer)
2. **Outgoing:** An outgoing Payment Request (you are the initiator/payee)

**Example**

*Split Account A (SAA) sends a PR to Split Account B (SAB) in order to get paid.*

*SAA would see the PR as an outgoing PR whilst SAB would see it as an incoming PR*

## Lifecycle

A PR can have the following states:

| State | Description |
|-------|-------------|
| `pending_approval` | Waiting for the payer to approve the payment request. |
| `approved` | The payer has approved the payment request. |
| `declined` | The payer has declined the payment request. |
| `cancelled` | The initiator has cancelled the payment request. |

## Request a payment [/payment_requests]
**Endpoint:** `/payment_requests`

### Make a payment on request | POST [POST]

+ Attributes
    + authoriser_id: `de86472c-c027-4735-a6a7-234366a27fc7` (string, required) - The Split account that will action/pay the PR
    + description: "Visible to both initiator and authoriser" (string, required) - Description visible to the initiator (payee) & authoriser (payer)
    + matures_at: "2016-12-19T02:10:56Z" (string, required) - Date & time in UTC ISO8601 that the payment will be processed if the request is approved
    + amount: 99000 (number, required) - Amount in cents to pay the initiator

+ Request (application/json)

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
        
+ Response 201 (application/json)

        {
          "data": {
            "ref": "PR.3",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "pending_approval",
            "responded_at": null,
            "created_at": "2016-12-19T02:10:56Z",
            "debit_ref": null,
            "payout": {
              "amount": 99000,
              "description": "The elite package for 4",
              "matures_at": "2016-12-25T00:00:00Z"
            }
          }
        }

## Approve a payment request [/payment_requests/{ref}/approve]
**Endpoint:** `/payment_requests{ref}/approve`

### Approve | POST [POST]

+ Parameters
    + ref: `PR.3` (string, required) - Payment request reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
            
+ Response 200 (application/json)

        {
          "data": {
            "ref": "PR.3",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "approved",
            "responded_at": "2016-12-19T02:38:04Z",
            "created_at": "2016-12-19T02:10:56Z",
            "credit_ref": "C.b",
            "payout": {
              "amount": 99000,
              "description": "The elite package for 4",
              "matures_at": "2016-12-25T00:00:00Z"
            }
          }
        }

## Decline a payment request [/payment_requests/{ref}/decline]
**Endpoint:** `/payment_requests/{ref}/decline`

### Decline | POST [POST]

+ Parameters
    + ref: `PR.3` (string, required) - Payment request reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
            
+ Response 200 (application/json)

        {
          "data": {
            "ref": "PR.3",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "declined",
            "responded_at": "2016-12-19T02:38:04Z",
            "created_at": "2016-12-19T02:10:56Z",
            "credit_ref": null,
            "payout": {
              "amount": 99000,
              "description": "The elite package for 4",
              "matures_at": "2016-12-25T00:00:00Z"
            }
          }
        }

## Get or cancel a payment request [/payment_requests/{ref}]
**Endpoint:** `/payment_requests/{ref}`

### Get a payment request | GET [GET]

+ Parameters
    + ref: `PR.3` (string, required) - Payment request reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)
    
        {
          "data": {
            "ref": "PR.3",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "approved",
            "responded_at": "2016-12-19T02:38:04Z",
            "created_at": "2016-12-19T02:10:56Z",
            "credit_ref": "C.b",
            "payout": {
              "amount": 99000,
              "description": "The elite package for 4",
              "matures_at": "2016-12-25T00:00:00Z"
            }
          }
        }

### Cancel a payment request | DELETE [DELETE]
A PR can only be cancelled if it has not yet been approved.

+ Parameters
    + ref: `PR.3` - Payment request reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 204 (application/json)

## Incoming payment requests [/payment_requests/incoming{?page}]
**Endpoint:** `/payment_requests/incoming{?page}`

### List incoming payment requests | GET [GET]

+ Parameters
    + page: 1 (optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.spli.cash/payment_requests/incoming?page=2>; rel="next", <http:/api-sandbox.split.cash/payment_requests/incoming?page=8>; rel="last"

    + Body
    
            {
              "data": [
                {
                  "ref": "PR.2",
                  "initiator_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
                  "authoriser_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
                  "status": "approved",
                  "responded_at": "2016-12-19T02:10:18Z",
                  "created_at": "2016-12-19T02:09:09Z",
                  "credit_ref": "C.a",
                  "payout": {
                    "amount": 30000,
                    "description": "The SuperPackage",
                    "matures_at": "2016-12-20T00:00:00Z"
                  }
                },
                {
                  "ref": "PR.3",
                  "initiator_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
                  "authoriser_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
                  "status": "pending_approval",
                  "responded_at": null,
                  "created_at": "2016-12-19T02:10:56Z",
                  "credit_ref": null,
                  "payout": {
                    "amount": 99000,
                    "description": "The elite package for 4",
                    "matures_at": "2016-12-25T00:00:00Z"
                  }
                }
              ]
            }

## Outgoing payment requests [/payment_requests/outgoing{?page}]
**Endpoint:** `/payment_requests/outgoing{?page}`

### List outgoing payment requests | GET [GET]

+ Parameters
    + page: 1 (optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.spli.cash/payment_requests/outgoing?page=2>; rel="next", <http:/api-sandbox.split.cash/payment_requests/outgoing?page=8>; rel="last"

    + Body
    
            {
              "data": [
                {
                  "ref": "PR.4",
                  "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
                  "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
                  "status": "approved",
                  "responded_at": "2016-12-19T02:10:18Z",
                  "created_at": "2016-12-19T02:09:09Z",
                  "debit_ref": "D.a",
                  "payout": {
                    "amount": 30000,
                    "description": "The SuperPackage",
                    "matures_at": "2016-12-20T00:00:00Z"
                  }
                },
                {
                  "ref": "PR.5",
                  "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
                  "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
                  "status": "pending_approval",
                  "responded_at": null,
                  "created_at": "2016-12-19T02:10:56Z",
                  "debit_ref": null,
                  "payout": {
                    "amount": 99000,
                    "description": "The elite package for 4",
                    "matures_at": "2016-12-25T00:00:00Z"
                  }
                }
              ]
            }

# Group Refund Requests
Manage refund requests applied against successfully processed payouts.

* A refunder corresponds to a recipient of a successfully processed payout.

  **Example**
  
  *SuperAgent has a successfully processed payment with two payouts: Snowmazing for $200 & Sandgeddon for $500.*

  *SuperAgent requests a refund from Snowmazing for $200. Snowmazing will receive a refund request which they may
  approve or decline. Snowmazing approves the request.*
  
  *Split will therefore process a refund for $200 from Snowmazing to SuperAgent*
  
## Lifecycle

A `refund_request` can have the following states:
| State | Description |
|-------|-------------|
| `pending_approval` | Waiting for the refunder to approve the refund request. |
| `approved` | The refunder has approved the refund request. |
| `declined` | The refunder has declined the refund request. |
| `cancelled` | The refund request has been cancelled. |

## Request a refund [/payout_refund_requests]
**Endpoint:** `/payout_refund_requests`

Certain rules apply to the creation of a refund:

* Must be applied against a successfully processed payout
* The refund amount requested from a payout recipient may not exceed the original amount of the payout

> **Note:** The original payout recipient(s) must approve the refund request before the refund gets processed.

### Request a refund | POST [POST]
#### Body Attributes
+ Attributes
    + `debit_ref`: `D.1` (string, required) - The payout ref to refund against
    + amount: 500 (number, required) - Amount in cents to request from the original payout recipient

+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9

+ Response 201 (application/json)

        {
          "data": {
            "ref": "RR.2",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "pending_approval",
            "responded_at": null,
            "created_at": "2016-12-19T04:34:38Z",
            "debit_ref": "D.1",
            "amount": 500
          }
        }
        
## Approve a payout refund request [/payout_refund_requests/{ref}/approve]
**Endpoint:** `/payout_refund_requests/{ref}/approve`

### Approve | POST [POST]

+ Parameters
    + ref: `PR.3` (string, required) - Payout refund request reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
            
+ Response 200 (application/json)

        {
          "data": {
            "ref": "RR.2",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "approved",
            "responded_at": "2016-12-19T04:42:59Z",
            "created_at": "2016-12-19T04:34:38Z",
            "credit_ref": "C.1",
            "amount": 100
          }
        }

## Decline a payout refund request [/payout_refund_requests/{ref}/decline]
**Endpoint:** `/payout_refund_requests/{ref}/decline`

### Decline | POST [POST]

+ Parameters
    + ref: `PR.3` (string, required) - Payout refund request reference
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
            
+ Response 200 (application/json)

        {
          "data": {
            "ref": "RR.2",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "declined",
            "responded_at": "2016-12-19T04:42:59Z",
            "created_at": "2016-12-19T04:34:38Z",
            "credit_ref": "C.1",
            "amount": 100
          }
        }
        
## Get or cancel a refund request [/payout_refund_requests/{ref}]
**Endpoint:** `/payout_refund_requests/{ref}`

A refund request can only be cancelled if it is still `pending_approval`.

### Retrieve a refund request | GET [GET]

+ Parameters
    + ref: `RR.2` (string, required) - refund request ref
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)
    
        {
          "data": {
            "ref": "RR.2",
            "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
            "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
            "status": "pending_approval",
            "responded_at": null,
            "created_at": "2016-12-19T04:34:38Z",
            "debit_ref": "D.1",
            "amount": 10000
          }
        }

### Cancel a refund request | DELETE [DELETE]

A refund request can only be canceled if it is pending approval.

+ Parameters
    + ref: `RR.2` (required) - refund request ref

+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9

+ Response 204

## Incoming refund requests [/payout_refund_requests/incoming{?page}]
**Endpoint:** `/payout_refund_requests/incoming{?page}`

### List incoming refund requests | GET [GET]

+ Parameters
    + page: 1 (optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.spli.cash/payout_refund_requests/incoming?page=2>; rel="next", <http:/api-sandbox.split.cash/payout_refund_requests/incoming?page=8>; rel="last"

    + Body
    
            {
              "data":
                [
                  {
                    "ref": "PRR.1",
                    "initiator_id": "48b89364-1577-4c81-ba02-96705895d457",
                    "authoriser_id": "dc6f1e60-3803-43ca-a200-7d641816f57f",
                    "status": "approved",
                    "responded_at": "2016-11-23T22:23:11Z",
                    "credit_ref": "C.1",
                    "amount": 5000
                  },
                  {
                    "ref": "PRR.2",
                    "initiator_id": "48b89364-1577-4c81-ba02-96705895d457",
                    "authoriser_id": "dc6f1e60-3803-43ca-a200-7d641816f57f",
                    "status": "pending_approval",
                    "responded_at": null,
                    "credit_ref": "C.2",
                    "amount": 10000
                  }
                ]
              }
            }

## Outgoing refund requests [/payout_refund_requests/outgoing{?page}]
**Endpoint:** `/payout_refund_requests/outgoing{?page}`

### List outgoing refund requests | GET [GET]

+ Parameters
    + page: 1 (optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.spli.cash/payout_refund_requests/outgoing?page=2>; rel="next", <http:/api-sandbox.split.cash/payout_refund_requests/outgoing?page=8>; rel="last"

    + Body
    
            {
              "data":
                [
                  {
                    "ref": "RR.1",
                    "initiator_id": "48b89364-1577-4c81-ba02-96705895d457",
                    "authoriser_id": "dc6f1e60-3803-43ca-a200-7d641816f57f",
                    "status": "pending_approval",
                    "responded_at": null,
                    "created_at": "2016-12-19T04:34:38Z",
                    "debit_ref": "D.1",
                    "amount": 5000
                  },
                  {
                    "ref": "RR.2",
                    "initiator_id": "ca7bc5b3-e47f-4153-96fb-bbe326b42772",
                    "authoriser_id": "fb6a9252-3818-44dc-b5aa-2195391a746f",
                    "status": "declined",
                    "responded_at": "2016-12-19T04:47:15Z",
                    "created_at": "2016-12-19T04:34:38Z",
                    "debit_ref": "D.1",
                    "amount": 10000
                  }
                ]
              }
            }

# Group Transactions
The transactions endpoint provides a detailed look at all past, current and future scheduled debits & credits relating
to the Split account.

In other words, we not only show the transactions initiated by the Split account but also show transactions where the Split account
is on the receiving end - even for payments that have not yet matured!


## List transactions [/transactions{?page}]

### List all transactions | GET [GET]

+ Parameters
    + page: 1 (optional) - page of results to return
    
+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9
    
+ Response 200 (application/json)

    + Headers

            Link: <http:/api-sandbox.spli.cash/transactions?page=2>; rel="next", <http:/api-sandbox.split.cash/transactions?page=8>; rel="last"

    + Body
    
            {  
              "data":[  
                {  
                  "ref":"D.3",
                  "parent_ref":null,
                  "type":"debit",
                  "category":"payout_refund",
                  "created_at":"2016-12-07T23:15:00.000Z",
                  "matures_on":"2016-12-10",
                  "cleared_at":null,
                  "bank_ref":null,
                  "status":"Pending",
                  "party_name":"Sanford-Rees",
                  "party_nickname":"sanford-rees-8",
                  "description":null,
                  "amount":1
                },
                {  
                  "ref":"D.2",
                  "parent_ref":"PB.2",
                  "type":"debit",
                  "category":"payout",
                  "created_at":"2016-12-06T23:15:00.000Z",
                  "matures_on":"2016-12-09",
                  "cleared_at":null,
                  "bank_ref":null,
                  "status":"Pending",
                  "party_name":"Gutmann-Schmidt",
                  "party_nickname":"gutmann-schmidt-6",
                  "description":null,
                  "amount":1
                },
                {  
                  "ref":"C.2",
                  "parent_ref":null,
                  "type":"credit",
                  "category":"payout",
                  "created_at":"2016-12-05T23:15:00.000Z",
                  "matures_on":"2016-12-05",
                  "cleared_at":"2016-12-05T23:15:00.000Z",
                  "bank_ref":"CT.1",
                  "status":"Pending",
                  "party_name":"Price and Sons",
                  "party_nickname":"price-and-sons-2",
                  "description":null,
                  "amount":1
                }
              ]
            }

# Group Users
All actions from this endpoint are performed against the currently authenticated user.

## Get or update user [/user]
**Endpoint:** `/user`

### Get user details | GET [GET]

+ Request

    + Headers
    
            Authorization: Bearer 147a57a47cc2b21bf7a51e460a2835b646129f41ee420ac73ebf0b5b805229a9

+ Response 200 (application/json)

        {
          "data": {
            "first_name": "Bear",
            "last_name": "Dog",
            "mobile_phone": "0456945832",
            "email": "bear@dog.com",
            "business": {
              "name": "Dog Bones Inc",
              "nickname": "dog-bones-inc",
              "abn": "129959040",
              "phone": "0418495033",
              "street_address": "98 Acme Avenue",
              "suburb": "Lead",
              "state": "NSW",
              "postcode": "2478"
            }
          }
        }